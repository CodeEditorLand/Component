{"version":3,"file":"Socket.DSvOdH79.js","sources":["../../../../node_modules/@solid-primitives/websocket/dist/index.js","../../../Wind/Target/Context/Connection/Socket.js"],"sourcesContent":["import { onCleanup, createSignal } from 'solid-js';\n\n// src/index.ts\nvar makeWS = (url, protocols, sendQueue = []) => {\n  const ws = new WebSocket(url, protocols);\n  const _send = ws.send.bind(ws);\n  ws.send = (msg) => ws.readyState == 1 ? _send(msg) : sendQueue.push(msg);\n  ws.addEventListener(\"open\", () => {\n    while (sendQueue.length)\n      _send(sendQueue.shift());\n  });\n  return ws;\n};\nvar createWS = (url, protocols) => {\n  const ws = makeWS(url, protocols);\n  onCleanup(() => ws.close());\n  return ws;\n};\nvar createWSState = (ws) => {\n  const [state, setState] = createSignal(ws.readyState);\n  const _close = ws.close.bind(ws);\n  ws.addEventListener(\"open\", () => setState(1));\n  ws.close = (...args) => {\n    _close(...args);\n    setState(2);\n  };\n  ws.addEventListener(\"close\", () => setState(3));\n  return state;\n};\nvar makeReconnectingWS = (url, protocols, options = {}) => {\n  let retries = options.retries || Infinity;\n  let ws;\n  const queue = [];\n  let events = [\n    [\n      \"close\",\n      () => {\n        retries-- > 0 && setTimeout(getWS, options.delay || 3e3);\n      }\n    ]\n  ];\n  const getWS = () => {\n    if (ws && ws.readyState < 2)\n      ws.close();\n    ws = Object.assign(makeWS(url, protocols, queue), {\n      reconnect: getWS\n    });\n    events.forEach((args) => ws.addEventListener(...args));\n  };\n  getWS();\n  const wws = {\n    close: (...args) => {\n      retries = 0;\n      return ws.close(...args);\n    },\n    addEventListener: (...args) => {\n      events.push(args);\n      return ws.addEventListener(...args);\n    },\n    removeEventListener: (...args) => {\n      events = events.filter((ev) => args[0] !== ev[0] || args[1] !== ev[1]);\n      return ws.removeEventListener(...args);\n    },\n    send: (msg) => {\n      wws.send.before?.();\n      return ws.send(msg);\n    }\n  };\n  for (const name in ws)\n    wws[name] == null && Object.defineProperty(wws, name, {\n      enumerable: true,\n      get: () => typeof ws[name] === \"function\" ? ws[name].bind(ws) : ws[name]\n    });\n  return wws;\n};\nvar createReconnectingWS = (url, protocols, options) => {\n  const ws = makeReconnectingWS(url, protocols, options);\n  onCleanup(() => ws.close());\n  return ws;\n};\nvar makeHeartbeatWS = (ws, options = {}) => {\n  let pingtimer;\n  let pongtimer;\n  const clearTimers = () => (clearTimeout(pingtimer), clearTimeout(pongtimer));\n  ws.send.before = () => {\n    clearTimers();\n    pongtimer = setTimeout(ws.reconnect, options.wait || 1500);\n  };\n  const receiveMessage = () => {\n    clearTimers();\n    pingtimer = setTimeout(() => ws.send(options.message || \"ping\"), options.interval || 1e3);\n  };\n  ws.addEventListener(\"close\", clearTimers);\n  ws.addEventListener(\"message\", receiveMessage);\n  ws.addEventListener(\"open\", () => setTimeout(receiveMessage, options.interval || 1e3));\n  return ws;\n};\n\nexport { createReconnectingWS, createWS, createWSState, makeHeartbeatWS, makeReconnectingWS, makeWS };\n","import e from\"../Environment/Context.js\";import{createReconnectingWS as t,makeHeartbeatWS as r}from\"@solid-primitives/websocket\";import{createSignal as a}from\"solid-js\";var m=a(r(t(e.Data[0]().Socket,void 0,{delay:0,retries:5}),{interval:5e4,message:\"beat\"}));export{m as default};\n"],"names":["makeWS","url","protocols","sendQueue","ws","_send","msg","createWSState","state","setState","createSignal","_close","args","makeReconnectingWS","options","retries","queue","events","getWS","wws","ev","name","createReconnectingWS","onCleanup","makeHeartbeatWS","pingtimer","pongtimer","clearTimers","receiveMessage","m","a","r","t","e"],"mappings":"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","x_google_ignoreList":[0]}