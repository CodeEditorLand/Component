import{p as m}from"./Context.3YWsnROk.js";import{createSignal as v,onCleanup as u}from"./solid.-melTDdq.js";var S=(t,o,a=[])=>{const r=new WebSocket(t,o),e=r.send.bind(r);return r.send=s=>r.readyState==1?e(s):a.push(s),r.addEventListener("open",()=>{for(;a.length;)e(a.shift())}),r},y=t=>{const[o,a]=v(t.readyState),r=t.close.bind(t);return t.addEventListener("open",()=>a(1)),t.close=(...e)=>{r(...e),a(2)},t.addEventListener("close",()=>a(3)),o},f=(t,o,a={})=>{let r=a.retries||1/0,e;const s=[];let c=[["close",()=>{r-- >0&&setTimeout(d,a.delay||3e3)}]];const d=()=>{e&&e.readyState<2&&e.close(),e=Object.assign(S(t,o,s),{reconnect:d}),c.forEach(n=>e.addEventListener(...n))};d();const i={close:(...n)=>(r=0,e.close(...n)),addEventListener:(...n)=>(c.push(n),e.addEventListener(...n)),removeEventListener:(...n)=>(c=c.filter(l=>n[0]!==l[0]||n[1]!==l[1]),e.removeEventListener(...n)),send:n=>(i.send.before?.(),e.send(n))};for(const n in e)i[n]==null&&Object.defineProperty(i,n,{enumerable:!0,get:()=>typeof e[n]=="function"?e[n].bind(e):e[n]});return i},b=(t,o,a)=>{const r=f(t,o,a);return u(()=>r.close()),r},p=(t,o={})=>{let a,r;const e=()=>(clearTimeout(a),clearTimeout(r));t.send.before=()=>{e(),r=setTimeout(t.reconnect,o.wait||1500)};const s=()=>{e(),a=setTimeout(()=>t.send(o.message||"ping"),o.interval||1e3)};return t.addEventListener("close",e),t.addEventListener("message",s),t.addEventListener("open",()=>setTimeout(s,o.interval||1e3)),t},g=v(p(b(m.Data[0]().Socket,void 0,{delay:0,retries:5}),{interval:5e4,message:"beat"}));const T=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{T as S,y as c,g as m};
//# sourceMappingURL=Socket.DSvOdH79.js.map
