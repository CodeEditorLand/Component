import{p as m}from"./Context.D1xlIlHy.js";import{createSignal as v,onCleanup as u}from"./solid.-melTDdq.js";var S=(e,t,n=[])=>{const s=new WebSocket(e,t),r=s.send.bind(s);return s.send=e=>1==s.readyState?r(e):n.push(e),s.addEventListener("open",(()=>{for(;n.length;)r(n.shift())})),s},y=e=>{const[t,n]=v(e.readyState),s=e.close.bind(e);return e.addEventListener("open",(()=>n(1))),e.close=(...e)=>{s(...e),n(2)},e.addEventListener("close",(()=>n(3))),t},f=(e,t,n={})=>{let s,r=n.retries||1/0;const o=[];let a=[["close",()=>{r-- >0&&setTimeout(d,n.delay||3e3)}]];const d=()=>{s&&s.readyState<2&&s.close(),s=Object.assign(S(e,t,o),{reconnect:d}),a.forEach((e=>s.addEventListener(...e)))};d();const i={close:(...e)=>(r=0,s.close(...e)),addEventListener:(...e)=>(a.push(e),s.addEventListener(...e)),removeEventListener:(...e)=>(a=a.filter((t=>e[0]!==t[0]||e[1]!==t[1])),s.removeEventListener(...e)),send:e=>(i.send.before?.(),s.send(e))};for(const e in s)null==i[e]&&Object.defineProperty(i,e,{enumerable:!0,get:()=>"function"==typeof s[e]?s[e].bind(s):s[e]});return i},b=(e,t,n)=>{const s=f(e,t,n);return u((()=>s.close())),s},p=(e,t={})=>{let n,s;const r=()=>(clearTimeout(n),clearTimeout(s));e.send.before=()=>{r(),s=setTimeout(e.reconnect,t.wait||1500)};const o=()=>{r(),n=setTimeout((()=>e.send(t.message||"ping")),t.interval||1e3)};return e.addEventListener("close",r),e.addEventListener("message",o),e.addEventListener("open",(()=>setTimeout(o,t.interval||1e3))),e},g=v(p(b(m.Data[0]().Socket,void 0,{delay:0,retries:5}),{interval:5e4,message:"beat"}));const T=Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));export{T as S,y as c,g as m};